

<%- include ("header.ejs") %>


<main class="main">
    <!-- Stats Section -->
    <section id="stats" class="section light-background" style="background-image: url('assets/img/kwl-bg.jpg'); background-size: inherit; background-position: inherit;">
        <div class="container section-title" data-aos="fade-up" style="padding-bottom: 0px;">
            <h2>Schedule Your Appointment</h2>
            <p>Effortlessly book your cargo pickup appointments and ensure a smooth collection process.</p>
        </div>
    </section>
    <!-- /Stats Section -->

    
    <!-- calendar Section -->
    <section class="appointment section">
        <div class="container">
            <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-10 colcontainer">
                    <!-- Tab Headers -->
                    <div class="tabs">
                        <div class="tab active" onclick="showTab(0)">1.CHOOSE APPOINTMENT</div>
                        <div class="tab" onclick="showTab(1)">2.CONTACT INFORMATION</div>
                        <div class="tab" onclick="showTab(2)">3.APPOINTMENT PREVIEW</div>
                    </div>

                    <!-- Tab Contents -->
                    <div id="tabContents">
                        <!-- Choose Appointment Tab -->
                        <div class="tab-content active">
                            <div class="row">
                                <div class="col-md-6">
                                    <label>* Appointment Type</label>
                                    <select name="option1" id="option" class="form-control select2 select2-danger select2-hidden-accessible" data-dropdown-css-class="select2-danger">
                                      <option value="">Services</option>
                                      <option value="Personal">Personal</option>
                                      <option value="Scheduled">Scheduled</option>
                                    </select>     
                                    <br>
                                    <label>Select Date</label>
                                    <!-- Calendar Section -->
                                    <div class="calendar">
                                        <div class="calendar-header">
                                            <span onclick="prevMonth()" class="calendaricon">&#706;</span>
                                            <div id="monthYear">October 2024</div>
                                            <span onclick="nextMonth()" class="calendaricon">&#707;</span>
                                        </div>
                                        <div class="calendar-days" id="calendarDays">
                                            <!-- Calendar days will be generated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <!-- Time Slots Section -->
                                    <div class="time-slots">
                                        <label>Select time</label>
                                        <div id="timeSlots">
                                            <!-- Time slots will be generated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Navigation Buttons -->
                            <div class="button-container">
                              <center><button class="btn btn-warning" id="nextBtn" onclick="nextStep()">Continue</button></center>
                            </div>
                        </div>

                        <!-- Your Info Tab -->
                        <div class="tab-content">
                            <form id="infoForm">
                                <div class="row gy-4 time-slots">
                                    <div class="col-md-6">
                                        <label>* TRN</label>
                                        <input type="text" id="trn" name="trn" class="form-control" placeholder="Enter the number" required="">
                                    </div>
                                    <div class="col-md-6"></div>
                                    <div class="col-md-6">
                                        <label>* First Name</label>
                                        <input type="test" id="fname" class="form-control" name="fname" placeholder="Enter the name" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>Last Name</label>
                                        <input type="text" id="lname" class="form-control" name="lname"  placeholder="Last Name" required="">
                                    </div>
                                    <div class="col-md-6">
                                      <label>* Mobile Number</label>
                                      <div class="input-group">
                                          <div class="input-group-prepend">
                                              <!-- Country Code Dropdown -->
                                              <select id="country-code" class="form-control" name="country-code" required style="padding: 0.575rem .75rem;">
                                                  <option value="+1">+1 (USA)</option>
                                                  <option value="+44">+44 (UK)</option>
                                                  <option value="+91">+91 (India)</option>
                                                  <!-- Add more country codes as needed -->
                                              </select>
                                          </div>
                                          <!-- Phone Number Input -->
                                          <input type="number" id="phone" class="form-control" name="phone" placeholder="Enter contact number" required style="margin: 0px 0px 0px 8px;">
                                      </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Email Address</label>
                                        <input type="email" id="email" class="form-control" name="email" placeholder="Enter the email" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Agent/Freight Forwarder</label>
                                        <input type="text" id="agent" class="form-control" name="agent"  placeholder="Enter the name" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Name of Individual Making Appointment</label>
                                        <input type="text" id="appname" class="form-control" name="appname" placeholder="Enter the data" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Appointment Type (Personal/Commercial)</label>
                                        <input type="text" id="apppersonal" class="form-control" name="apppersonal"  placeholder="Enter the appointment type" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Bill of Lading Number</label>
                                        <input type="text" id="blnumber" class="form-control" name="blnumber" placeholder="Enter the number" required="">
                                    </div>
                                    <div class="col-md-12">
                                        <label>* Vessel Name (needed for verification as Bill of Lading Numbers are not unique)</label>
                                        <input type="text" id="vname" class="form-control" name="vname" placeholder="Enter the vessel name" required="">
                                    </div>
                                    <div class="col-md-12">
                                        <label>* Vessel Reported Date (needed for verification as Bill of Lading Numbers are not unique)</label>
                                        <input type="text" id="vreport" class="form-control" name="vreport"  placeholder="Vessel Reported Date" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Chassis No (in the case of Motor Unit Appointments)</label>
                                        <input type="text" id="chassis" class="form-control" name="chassis"  placeholder="Enter the number" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Customs Release/IMS4 Declaration Number</label>
                                        <input type="text" id="ims" class="form-control" name="ims" placeholder="Customs Release/IMS4 Declaration Number" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>Container Number</label>
                                        <input type="number" id="cnumber" class="form-control" name="cnumber" placeholder="Enter the data" required="">
                                    </div>
                                    <div class="col-md-6">
                                        <label>* Number of Pieces/Packages</label>
                                        <input type="text" id="ppnumber" class="form-control" name="ppnumber" placeholder="Enter the packages" required="">
                                    </div>
                                </div>
                            </form>
                            <!-- Navigation Buttons -->
                            <div class="button-container">
                              <center>
                                <button class="btn btn-warning" id="prevBtn" onclick="changeTab(-1)" disabled>Previous</button>
                                <button class="btn btn-warning" id="nextBtn" onclick="nextStep()">Continue</button>
                              </center>
                            </div>
                        </div>

                        <!-- Confirmation Tab -->
                        <div class="tab-content">
                          <div class="row time-slots">
                            <h5>APPOINTMENT DETAILS</h5>
                            <p><strong>Date:</strong> <span id="selectedDate">05/11/2024</span></p>
                            <p><strong>Time:</strong> <span id="selectedTime">10:30 PM</span></p>
                            <br>
                            <h5>CONTACT INFORMATION</h5>
                            <p><strong>TRN:</strong> Consultation</p>
                            <p><strong>First Name:</strong> <span id="selectedDate">N/A</span></p>
                            <p><strong>Last Name:</strong> <span id="selectedTime">N/A</span></p>
                            <p><strong>Mobile Number:</strong> <span id="confirmName">N/A</span></p>
                            <p><strong>Email Address:</strong> <span id="confirmEmail">N/A</span></p>
                            <p><strong>Agent/Freight Forwarder</strong> None</p>
                            <p><strong>Name of Individual Making Appointment</strong> None</p>
                            <p><strong>Appointment Type (Personal/Commercial)</strong> None</p>
                            <p><strong>Bill of Lading Number</strong> None</p>
                            <p><strong>Vessel Name</strong> None</p>
                            <p><strong>Vessel Reported Date</strong> None</p>
                            <p><strong>Chassis No</strong> None</p>
                            <p><strong>Customs Release/IMS4 Declaration Number</strong> None</p>
                            <p><strong>Container Number</strong> None</p>
                            <p><strong>Number of Pieces/Packages</strong> None</p>

                            <!-- Navigation Buttons -->
                            <div class="button-container">
                              <center>
                                <button class="btn btn-warning" id="prevBtn" onclick="changeTab(-1)" disabled>Previous</button>
                                <button class="btn btn-warning" id="nextBtn" onclick="confirmBooking()">Submit</button>
                              </center>
                            </div>
                          </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-1"></div>
            </div>
        </div>
    </section>
    <!-- calendar Section -->

</main>


    
<%- include ("footer.ejs") %>


<!-- Calendar JS -->
<script>
    let currentTab = 0;
    let selectedDate = null;
    let selectedTimes = [];
    const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    let currentMonth = 9; // October
    let currentYear = 2024;

    document.addEventListener("DOMContentLoaded", () => {
        renderCalendar(currentMonth, currentYear);
        showTab(currentTab);
    });

    function showTab(index) {
        const tabs = document.querySelectorAll(".tab");
        const contents = document.querySelectorAll(".tab-content");

        tabs.forEach((tab, i) => tab.classList.toggle("active", i === index));
        contents.forEach((content, i) => content.classList.toggle("active", i === index));

        document.getElementById("prevBtn").disabled = index === 0;
        document.getElementById("nextBtn").textContent = index === contents.length - 1 ? "Confirm" : "Continue";
    }

    function changeTab(direction) {
        const tabs = document.querySelectorAll(".tab-content");
        currentTab = Math.min(Math.max(currentTab + direction, 0), tabs.length - 1);
        showTab(currentTab);
    }

    function nextStep() {
        if (currentTab === 1) {
            if (!validateInfo()) return;
        }
        if (currentTab === 2) {
            populateConfirmation();
        }
        changeTab(1);
    }

    function validateInfo() {
        const trn = document.getElementById("trn").value.trim();
        const fname = document.getElementById("fname").value.trim();
        const lname = document.getElementById("lname").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const email = document.getElementById("email").value.trim();
        const agent = document.getElementById("agent").value.trim();
        const appname = document.getElementById("appname").value.trim();
        const apppersonal = document.getElementById("apppersonal").value.trim();
        const vname = document.getElementById("vname").value.trim();
        const vreport = document.getElementById("vreport").value.trim();
        const blnumber = document.getElementById("blnumber").value.trim();
        const chassis = document.getElementById("chassis").value.trim();
        const ims = document.getElementById("ims").value.trim();
        const cnumber = document.getElementById("cnumber").value.trim();
        const ppnumber = document.getElementById("ppnumber").value.trim();

        if (trn && fname && lname && phone && email && agent && appname && apppersonal && vname && vreport && blnumber && chassis && ims && cnumber && ppnumber) return true;
        alert("Please fill out all fields");
        return false;
    }

    function populateConfirmation() {
    if (!selectedDate || selectedTimes.length === 0) {
        alert("Please select a date and at least one time slot before confirming.");
        return;
    }

        // Populate confirmation fields with selected information
        document.getElementById("selectedDate").textContent = selectedDate;
        document.getElementById("selectedTime").textContent = selectedTimes.length > 0 ? selectedTimes.join(", ") : "N/A";
        document.getElementById("confirmName").textContent = document.getElementById("fname").value;
        document.getElementById("confirmEmail").textContent = document.getElementById("email").value || "N/A";
    }

    function confirmBooking() {
        Swal.fire("Appointment Confirmed!", "Your booking has been successfully made.", "success");
    }
    
    function renderCalendar(month, year) {
        const calendarDays = document.getElementById("calendarDays");
        const monthYear = document.getElementById("monthYear");
        calendarDays.innerHTML = "";
        monthYear.textContent = `${monthNames[month]} ${year}`;
        for (let i = 1; i <= 31; i++) { // Simplified 31 days for demo
            const dayElement = document.createElement("div");
            dayElement.className = "day";
            dayElement.textContent = i;
            dayElement.onclick = () => selectDate(i);
            calendarDays.appendChild(dayElement);
        }
    }

    function selectDate(day) {
        selectedDate = `${monthNames[currentMonth]} ${day}, ${currentYear}`;
        document.querySelectorAll(".day").forEach(d => d.classList.remove("selected-day"));
        event.target.classList.add("selected-day");
        renderTimeSlots();
    }

    function renderTimeSlots() {
        const timeSlots = document.getElementById("timeSlots");
        timeSlots.innerHTML = "";
        ["9:00 AM", "11:00 AM", "1:00 PM", "3:00 PM"].forEach(time => {
            const slot = document.createElement("div");
            slot.className = "time-slot";
            slot.textContent = time;
            slot.onclick = () => selectTime(slot, time);
            timeSlots.appendChild(slot);
        });
    }

    function selectTime(slot, time) {
        if (selectedTimes.includes(time)) {
            selectedTimes = selectedTimes.filter(t => t !== time);
            slot.classList.remove("selected-time");
        } else {
            selectedTimes.push(time);
            slot.classList.add("selected-time");
        }
    }

    function prevMonth() {
        currentMonth = (currentMonth === 0) ? 11 : currentMonth - 1;
        renderCalendar(currentMonth, currentYear);
    }

    function nextMonth() {
        currentMonth = (currentMonth === 11) ? 0 : currentMonth + 1;
        renderCalendar(currentMonth, currentYear);
    }
</script>
